<!doctype html>
<html lang="en">
  <head>
    <title>Daily Portal</title>
  </head>

  <body>
    <h2>Current time</h2>
    {% for t in times %}
      <p>{{ t }}: {{ times[t].city_time }}</p>
    {% endfor %}


    <h2>Weather forecast</h2>
      {% for city in forecasts %}
        <p>{{ city }}:</p>
        <script>
            var req = new XMLHttpRequest();

            //Get data from server
            req.onreadystatechange = function()
            {
                if (req.readyState == 4) {
                    if (req.status != 200) {
                        console.log("Load error.");
                    } else {
                        console.log("Got response.");
                        //how to load image?
                        // create tag?
                    }
                }
            };
            //Send data to server
            req.open('POST', '/weather');
            req.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            req.send('cityname=' + {{ city }});
            //return false;
        </script>

        {# <img src="/weather.png" /> #}

        {# {% if city == "Paris" %}
            <img src="/weather-paris.png" />
        {% endif %}
        {% if city == "Tokyo" %}
            <img src="/weather-tokyo.png" />
        {% endif %}
        {% if city == "Montreal" %}
            <img src="/weather-montreal.png" />
        {% endif %} #}

        <ul>
          {% for f in forecasts[city] %}
            <li>
              {{ f.datehours }}<br>
              {{ f.main }},
              {{ f.description }},
              {{ f.icon }},
              {{ f.temp }}Â°C,
              {{ f.humidity }}%,
              {{ f.wind }}m/sec,
              {{ f.clouds }}%
            </li>
          {% endfor %}
        </ul>
      {% endfor %}


    <h2>RATP info</h2>
      <p>Next train in Sceaux station: </p>
      <ul>
      {% for d in trains.directions %}
          <li>
          {{ d }}:
              {% if d == 'Charles-de-Gaulle. Mitry-Claye.' %}
                  {% for time1 in trains.passingtimes_dir1 %}
                      {{ time1 }}
                  {% endfor %}
              {% else %}
                  {% for time2 in trains.passingtimes_dir2 %}
                      {{ time2 }}
                  {% endfor %}
              {% endif %}
          </li>
      {% endfor %}
    </ul>
  </body>
</html>
